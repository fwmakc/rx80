# Регистры

## Аккумулятор

**AX** - 16-битный регистр аккумулятора, используется для хранения результата арифметических действий.

Может разбиваться на пару 8-битных регистров: **AH, AL**.

## Регистры общего назначения

**BX, CX, DX** - 16-битные регистры общего назначения. Могут разбиваться на пары, образуя таким образом по два 8-битных регистра: **BH, BL, CH, CL, DH, DL**.

Регистр **BX** обычно используется для адресации памяти.

## Флаговый регистр

**F** - 8-битный регистр, состоящий их 8-ми 1-битных флагов. Каждый бит имеет свое название:

```
  0   0   0   0   0   0   0   0
| S | Z | x | H | O | P | N | C |
```

Флаг считается активным, если в соответствующем бите записана единица, и не активным, если записан ноль.

Флаги меняются после арифметических или логических операций процессора и отражают последний результат.

**C** (carry) — флаг переноса. Устанавливается, если в итоге выполнения арифметических операций произошел перенос (в сложении) либо заем (в вычитании) старшего бита. Этот флаг проверяется арифметическими инструкциями для обработки значений, слишком больших для одного регистра.

**N** (negative) — флаг отрицательного результата. Устанавливается при получении отрицательного результата арифметической операции.

**P** (parity) флаг четности. Устанавливается, если количество установленных битов в младшем байте кратно 2.

**O** (overflow) флаг переполнения. Устанавливается, если знаковые арифметические операции приводят к значению, слишком большому для регистра.

**Н** (half-carry) — флаг вспомогательного переноса. Устанавливается, если произошел перенос (заем) в 4-й бит аккумулятора. Используется при проведении двоично-десятичной коррекции при работе с BCD-арифметикой;

**Z** (zero) — флаг нуля. Устанавливается, если результат операции равен нулю.

**S** (sign) — флаг вычитания. Устанавливается, если предыдущей командой было вычитание. В BCD-арифметике помогает определить тип предыдущей операции.

Флаги, помеченные **x**, не используются.

## Теневые регистры

Это альтернативный набор регистров **AX, BX, CX, DX, F**.

Процессор может использовать их для быстрого переключения контекста или выполнения операций, требующих временного сохранения исходных регистров.

Обозначаются как **AX', BX', CX', DX', F'**, в парах - **AH', AL', BH', BL', CH', CL', DH', DL'**.

Они полностью дублируют основные регистры и их функционал. Это позволяет быстро переключаться между двумя наборами регистров без необходимости сохранять и восстанавливать их данные вручную в памяти.

Переключение вызывается специальной инструкцией.

## Индексные регистры

**IX, IY** - специальные 16-битные регистры, используются для адресации данных со смещением.

## Указатель стека

**SP** - 16-битный регистр, который хранит адрес верхней ячейки стека в памяти.

## Счетчик команд

**PC** - 16-битный регистр, указывающий на адрес следующей выполняемой инструкции в памяти. 

## Регистр прерываний

**I** (Interrupt Vector Register) - 8-битный регистр, служит для задания старшей половины вектора прерывания в режиме прерываний процессора.

## BCD-арифметика

BCD-арифметика — это арифметические операции над числами, представленными в двоично-десятичном коде (BCD, Binary-Coded Decimal).

В BCD каждая десятичная цифра числа (от 0 до 9) кодируется четырёхбитным двоичным числом:

> например, 5 кодируется как 0101.

Такая система применяется там, где важно точное десятичное представление, как в финансовых расчётах, поскольку она позволяет избежать ошибок округления, присущих прямой двоичной системе. 

Кодирование цифр:

Четыре бита могут представить 16 различных значений (от 0000 до 1111), но в BCD используются только первые 10 комбинаций (от 0000 до 1001), которые соответствуют десятичным цифрам от 0 до 9. Остальные 6 комбинаций (1010-1111) не используются.

Пример:

Десятичное число 311 записывается в BCD как 0011 0001 0001, где 0011 — это 3, 0001 — это 1, и 0001 — это снова 1. 

В чистой двоичной системе число 311 было бы представлено как 0001 0011 0111. 

Счетчики:

4-битные BCD-счетчики могут считать от 0 до 9, а при 10-м импульсе обнуляются, что упрощает реализацию десятичных счетчиков. 
